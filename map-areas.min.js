/*!
 * MapArea
 * https://github.com/caboodle-tech/map-area
 *
 * Version: 2.0.0
 *
 * Copyright Christopher Keers (Caboodle Tech Inc)
 * https://github.com/blizzardengle (https://github.com/caboodle-tech)
 *
 * Released under the MIT license.
 * Released: 2020-03-31
 * Updated: 2020-04-14
 */
var MapArea=function(){"use strict";var e,t,r={keys:[]},n=function(){var r=new Date;null!=e&&r.getTime()>e+50&&(clearInterval(t),t="",e="",o()),e=r.getTime()},a=function(e){e.click()},s=function(e,t,n){t.parentElement.style.position="relative";var s,l,o,c,u,d,p,h,m,f=t.parentElement,g=e.querySelectorAll("area"),w=g.length,v="0 0 "+t.naturalWidth+" "+t.naturalHeight,y="width: "+t.naturalWidth+"px; height: "+t.naturalHeight+"px;",b="map-area";n.className?b=n.className:n.className=b;var A,k,M=t.offsetWidth/(t.naturalWidth||t.width),N=document.createElementNS("http://www.w3.org/2000/svg","svg");for(N.setAttribute("viewBox",v),N.setAttribute("xmlns","http://www.w3.org/2000/svg"),N.setAttribute("style","position: absolute; z-index: 9000; overflow: visible; "+y),r[n.uid]=[N,e,t,n],r.keys.push(n.uid),A=0;A<w;A++){for(g[A].dataset.coords?s=g[A].dataset.coords:(s=g[A].coords,g[A].dataset.coords=s),s=(s=s.replace(/ /g,"")).split(","),k=0;k<s.length;k++)s[k]=Math.ceil(s[k]*M);switch(g[A].coords=s.join(","),g[A].shape){case"rect":case"rectangle":d=parseInt(s[0]),(p=parseInt(s[2])-parseInt(s[0]))<0&&(d-=p*=-1),u=parseInt(s[1]),(h=parseInt(s[3])-parseInt(s[1]))<0&&(u-=h*=-1),(m=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",d),m.setAttribute("y",u),m.setAttribute("width",p),m.setAttribute("height",h),m.setAttribute("class",b+" rectangle"),c=!0;break;case"circ":case"circle":(m=document.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("cx",s[0]),m.setAttribute("cy",s[1]),m.setAttribute("r",s[2]),m.setAttribute("class",b+" circle"),c=!0;break;case"poly":case"polygon":for(l="",o=s.length,k=0;k<o;k+=2)l+=s[k]+","+s[k+1]+" ";l=l.trim(),(m=document.createElementNS("http://www.w3.org/2000/svg","polygon")).setAttribute("points",l),m.setAttribute("class",b+" polygon"),c=!0}c&&(m.addEventListener("click",a.bind(null,g[A])),m.setAttribute("style","cursor: pointer;"),m.innerHTML="<title>"+g[A].title+"</title>",N.appendChild(m))}f.insertBefore(N,f.firstElementChild),window.addEventListener("resize",i)},i=function(){null!=t&&""!=t||(t=setInterval(n,50))},l=function(e){e=parseInt(e),(isNaN(e)||e<5)&&(e=5);for(var t=i(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]),r=i(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"]),n=t[Math.floor(51*Math.random())],a=(e=e-1,0),s=0;s<e;s++)(a=Math.floor(61*Math.random())+a)>61&&(a%=61),n+=r[a];function i(e){for(var t,r,n=e.length;0!==n;)r=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[r],e[r]=t;return e}return n},o=function(){var e,t=[];for(e=0;e<r.keys.length;e++)r[r.keys[e]][0].parentNode.removeChild(r[r.keys[e]][0]),r[r.keys[e]][0]=null,t.push([r[r.keys[e]][1],r[r.keys[e]][2],r[r.keys[e]][3]]),r[r.keys[e]]=[];for(r.keys=[],e=0;e<t.length;e++)s(t[e][0],t[e][1],t[e][2])};return{addAll:function(e){var t,r,n,a=[];e||(e={});for(var i=document.querySelectorAll("[usemap]"),o=0;o<i.length;o++)(n=(r=i[o]).useMap)&&(e.uid=l(),e.name=n.replace("#",""),t=document.querySelector('map[name="'+e.name+'"]'),s(t,r,e),a.push(e.uid));return a},addMap:function(e){var t,r;if(e.name&&(t=document.querySelector('map[name="'+e.name+'"]'))&&(r=document.querySelector('img[usemap="#'+e.name+'"]')))return e.uid=l(),s(t,r,e),e.uid},updateAll:function(){o()},updateMap:function(e){!function(e){r[e]&&(r.keys.splice(r.keys.indexOf(r[e]),1),r[e][0].parentNode.removeChild(r[e][0]),r[e][0]=null,s(r[e][1],r[e][2],r[e][3]))}(e)}}};
